<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Undangan Digital - Addakwa</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@7.22.10/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const Invitation = () => {
      const [invitationData, setInvitationData] = useState(null);
      const [recipient, setRecipient] = useState('');

      useEffect(() => {
        // Ambil parameter 'to' dari URL
        const urlParams = new URLSearchParams(window.location.search);
        const recipientName = urlParams.get('to') || 'Tamu Undangan';
        setRecipient(recipientName);

        // Ambil data undangan dari file JSON
        // Ganti path ini sesuai dengan folder klien di Vercel
        fetch('/clients/haflatul-wada-29/config.json')
          .then(response => response.json())
          .then(data => setInvitationData(data))
          .catch(error => console.error('Error fetching invitation data:', error));
      }, []);

      if (!invitationData) {
        return <div className="text-center text-gray-500">Loading...</div>;
      }

      return (
        <div className="min-h-screen bg-gray-100 font-sans">
          {/* Header */}
          <header className="bg-green-600 text-white text-center py-10">
            <h1 className="text-4xl font-bold">{invitationData.title}</h1>
            <h2 className="text-2xl mt-2">{invitationData.organizer}</h2>
            <p className="mt-4">{invitationData.date} / {invitationData.hijriDate}</p>
          </header>

          {/* Greeting */}
          <section className="text-center py-10">
            <p className="text-2xl font-arabic">{invitationData.greeting}</p>
            <p className="mt-4">Kepada Yth, {recipient}</p>
            <p className="mt-2">Tanpa mengurangi rasa hormat, kami mengundang Bapak/Ibu untuk menghadiri:</p>
            <div className="mt-4">
              <p><strong>Acara:</strong> {invitationData.event}</p>
              <p><strong>Hari/Tanggal:</strong> {invitationData.date}</p>
              <p><strong>Waktu:</strong> {invitationData.time}</p>
              <p><strong>Tempat:</strong> {invitationData.location}</p>
            </div>
          </section>

          {/* Event Schedule */}
          <section className="bg-white py-10 px-4">
            <h3 className="text-2xl font-bold text-center mb-6">Susunan Acara</h3>
            <ol className="list-decimal list-inside mx-auto max-w-2xl">
              {invitationData.schedule.map((item, index) => (
                <li key={index} className="mb-2">{item}</li>
              ))}
            </ol>
          </section>

          {/* Message for Graduates */}
          <section className="py-10 text-center bg-gray-50">
            <h3 className="text-2xl font-bold mb-4">{invitationData.messageTitle}</h3>
            <p className="mx-auto max-w-2xl">{invitationData.message}</p>
          </section>

          {/* Rules */}
          <section className="bg-white py-10 px-4">
            <h3 className="text-2xl font-bold text-center mb-6">Tata Tertib Acara</h3>
            <ol className="list-decimal list-inside mx-auto max-w-2xl">
              {invitationData.rules.map((rule, index) => (
                <li key={index} className="mb-2">{rule}</li>
              ))}
            </ol>
          </section>

          {/* Footer */}
          <footer className="bg-green-600 text-white text-center py-6">
            <p>Terima kasih atas perhatian dan doa restu Anda.</p>
            <p className="mt-2">Build with <a href="https://addakwa.com" className="underline">Addakwa</a></p>
          </footer>
        </div>
      );
    };

    ReactDOM.render(<Invitation />, document.getElementById('root'));

    const client = window.location.pathname.split('/')[1]; // Ambil 'undanganhaflah' dari URL
        fetch(`/clients/${client}/config.json`)
  </script>
</body>
</html>